# Space Mine Crafter — концепт и дизайн (Story / GDD-lite)

## High concept
Аркадный top-down space-shooter с мета-прогрессией: игрок вылетает на добычу в «шахту» (уровень), уничтожает астероиды и врагов, собирает минералы (валюта) и скрап (крафт), возвращается в меню и постепенно развивает корабль через дерево улучшений, крафт и квесты. Прогресс сохраняется между запусками.

## Игровой цикл (core loop)
1) Меню (мета-слой):
- Улучшения (Update): покупка апгрейдов, открывающих новые ветки.
- Крафт (Craft): создание усилителей/оружия за скрап + минералы.
- Квесты (Quests): простые задачи с наградами.
- Выбор уровня (Level selector): доступ к следующему уровню открывается после прохождения текущего.
- Кнопка «Go to mine» доступна всегда (внизу экрана), вне зависимости от вкладки.
  - Примечание по интерфейсу: меню и мета-прогрессия — это «сложный UI» (вкладки/дерево/крафт/квесты + нижняя панель), который живёт поверх игрового canvas; HUD уровня остаётся внутри уровня.

2) Вылет (ран / уровень):
- Эффект «warp-входа»: корабль быстро прилетает из-за экрана в центр (камера/корабль + шлейф/размытие).
- Появляются астероиды: летят хаотично, медленно, с небольшими различиями в скорости и направлении.
- Игрок разрушает астероиды → лут:
  - Минералы (основная валюта на улучшения).
  - Малый шанс скрапа (крафт-материал).
- Со временем/по прогрессу уничтожений начинают появляться враги; чем выше уровень — тем выше плотность/сложность.
- Ограничитель ран-тайма: топливо.
  - Движение тратит топливо; если топливо кончилось — ран завершается, игрок возвращается в меню с добычей.
- Опасность: столкновения и вражеский огонь тратят здоровье.
  - В самом начале любое столкновение смертельно — ощущение «хрупкого старта», мотивирующее апгрейды.

3) Завершение:
- Чтобы пройти уровень «успешно», нужно дожить до босса и победить его.
- Победа открывает следующий уровень (и потенциально новые ветки/рецепты/квесты).

## Управление и ощущения (feel)
- Наведение: корабль всегда развёрнут в сторону курсора мыши.
- Движение: WASD (инерционное).
  - Нет мгновенной остановки/разгона: есть ускорение, максимальная скорость, трение/демпфирование.
- Стрельба: левая кнопка мыши.
- Ключевая цель ощущений: «я пилотирую массу», а не курсор — корабль управляемый, но с инерцией.

## HUD / UI во время уровня
- Сверху слева:
  - Здоровье корабля.
  - Топливо (если показываем явно — желательно).
  - Счётчик ресурсов, собранных в текущем уровне (минералы/скрап).
- Остальной экран — чистый, чтобы хорошо читались угрозы и траектории.
  - HUD — часть уровня (рендерится вместе со сценой), чтобы не ломать ощущение «всё в игре» и упростить синхронизацию с ран-таймом.

## Сущности и угрозы
### Астероиды
- Разные типы (по размеру/прочности/лутабельности), но стартово достаточно 1–2 типа.
- Имеют здоровье; в начале уничтожать сложно (низкий урон игрока).
- Движение хаотичное: небольшие скорости, лёгкий дрейф, возможная лёгкая ротация.
- Столкновения:
  - Наносят урон кораблю.
  - На ранних этапах — смертельно (или почти смертельно), чтобы апгрейды «здоровья/щита» были значимы.

### Враги
- Появляются постепенно после порога прогресса (например: по времени + по количеству уничтоженных астероидов).
- Дают больше скрапа/минералов, но:
  - Больше здоровья.
  - Стреляют по игроку (пули/лазерные болты).
  - Требуют манёвра и уклонения.
- Рост сложности по уровням:
  - Больше количество.
  - Чуть быстрее/умнее.
  - Плотнее огонь.
  - Больше HP.

### Босс
- Большой корабль с несколькими фазами и читаемыми атаками.
- Цель дизайна: «танец уклонений» + окно для нанесения урона.
- Примеры атак:
  - Веерные залпы.
  - Круговой залп.
  - Ракеты/самонаводящиеся с телеграфом.
  - Луч/лазер с предупреждением (линия прицеливания).
- Победа над боссом = прохождение уровня.

## Мета-прогрессия
### Валюты и материалы
- Минералы: основная валюта для апгрейдов в дереве.
- Скрап: редкий материал для крафта усилителей/оружия.

### Дерево улучшений (Update)
- Основная идея: дерево «раскрывается» постепенно.
- Правило открытия:
  - Пока улучшение не куплено — следующие за ним узлы скрыты/затемнены.
  - После покупки — открываются дочерние улучшения.
- Ветки и примеры узлов:
  - Урон (Damage): +урон, +скорострельность, +крит, +пробивание, +взрывной урон.
  - Выживаемость (Defense): +HP, реген/ремонт, щит, сопротивление столкновениям, временная неуязвимость.
  - Мобильность (Mobility): +ускорение, +макс скорость, -расход топлива, улучшенный разворот, рывок.
  - Оружие (Weapons): вторая пуля, сплит-шот, турель-дрон, альтернативный режим огня.
  - Экономика (Economy): +дроп минералов, +шанс скрапа, автосбор, бонусы за серию.
- Цены растут по мере продвижения по ветке; поздние апгрейды ощутимо дороже ранних.

### Крафт (Craft)
- Рецепты требуют скрап + минералы.
- Результат:
  - Усилители (consumable или постоянные моды): например +10% урон на ран, +щит на старт, +магнит к луту.
  - Новые орудия/модули: например «двойной выстрел» как модуль, если не хотим держать это только в дереве.
- Важно: крафт не должен делать дерево бесполезным; он дополняет билды.

### Квесты (Quests)
- Простые, понятные, короткие:
  - Уничтожь N астероидов.
  - Собери X минералов за ран.
  - Победи Y врагов.
  - Пройди уровень без столкновений (сложный челлендж).
- Награды:
  - Минералы, скрап, временные бустеры, иногда «ключи» открытия рецептов/веток.

## Баланс и темп
Цель: не «душно», но и не «за 10 минут всё пройдено».
- Ранний этап:
  - Сложно ломать астероиды, опасно сталкиваться, мало топлива → короткие забеги → быстрый возврат в меню → частые маленькие апгрейды.
- Средний этап:
  - Появляются враги, растёт доход, появляется выбор билдов.
- Поздний этап:
  - Боссы, вариативность атак, требования к манёвру и позиционированию.
- Экономика:
  - Минералы стабильны и предсказуемы.
  - Скрап редкий и «вкусный» (особенно с врагов).

## Сохранение прогресса
- Прогресс не сбрасывается при перезапуске:
  - Купленные апгрейды.
  - Открытые уровни.
  - Выполненные квесты (или статус/кулдауны).
  - Открытые рецепты/скрафченные модули.
- В ран-тайме хранится только текущий лут; при завершении рана лут конвертируется в общий прогресс.

## Конфиг и настраиваемость
Все параметры геймплея должны быть вынесены в отдельный конфиг-файл констант и подписаны:
- Движение/инерция/расход топлива.
- HP/урон/скорострельность.
- Дроп-таблицы и цены.
- Спавн астероидов/врагов/босса.
- Порог появления врагов и босса.